var e=Object.assign;import{P as t}from"./vendor.21f5455c.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(s){const i=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((s,r)=>{const o=new URL(e,i);if(self[t].moduleMap[o])return s(self[t].moduleMap[o]);const n=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),h=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(n),onerror(){r(new Error(`Failed to import: ${e}`)),a(h)},onload(){s(self[t].moduleMap[o]),a(h)}});document.head.appendChild(h)})),self[t].moduleMap={}}}("/assets/");var s={type:t.AUTO,parent:"game",backgroundColor:"#008894",pixelArt:!0,scale:{width:800,height:600,mode:t.Scale.FIT,autoCenter:t.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{tileBias:4,gravity:{y:250}}}};const i={gameOver:!1,moving:!1,score:0};Object.freeze(i);class a extends Phaser.Physics.Arcade.Sprite{static preload(e){e.load.image("norby","assets/sprites/norby.png"),e.load.image("norby_dead","assets/sprites/deadnorby.png"),e.load.audio("flap","assets/audio/wing.wav"),e.load.audio("hit","assets/audio/hit.wav"),e.load.audio("point","assets/audio/point.wav")}constructor(e,t,s,i,a,r){super(e,t,s,i),e.add.existing(this),e.physics.add.existing(this),e.events.on("update",this.update,this),this.scene=e,this.setCollideWorldBounds(!0),this.body.onWorldBounds=!0,e.physics.world.on("worldbounds",(()=>this.die())),this.setBounce(.4),this.canJump=!0,this.alive=!0,this.startedJumpRestore=!1,this.flapForce=300,this.jumpKey=e.input.keyboard.addKey(r),this.textureName=i,this.deadTexture=a,this.startPosition={x:t,y:s}}collideAgainst(e){this.scene.physics.add.collider(this,e,this.die,null,this)}die(){this.alive&&(this.alive=!1,this.body.setDrag(80),this.setTexture(this.deadTexture),this.startGameOver(),this.setVelocityX(this.flapForce/2),this.scene.sound.play("hit"))}update(){this.alive&&(this.jumpKey.isDown&&this.canJump&&(this.setVelocityY(-this.flapForce),this.angle=-20,this.canJump=!1,this.scene.sound.play("flap"),this.waiting&&(this.waiting=!1,this.tween.remove(),this.body.allowGravity=!0,this.body.setGravityY(600),this.startGame())),!this.jumpKey.isUp||this.canJump||this.startedJumpRestore||(this.scene.time.delayedCall(100,(()=>{this.canJump=!0,this.startedJumpRestore=!1})),this.startedJumpRestore=!0),this.waiting||(this.angle+=2))}StartScreenBob(){this.body.allowGravity=!1,this.tween=this.scene.tweens.add({targets:this,y:this.y+20,duration:1500,ease:"Sine.inOut",yoyo:!0,repeat:-1}),this.waiting=!0}Reset(){this.x=this.startPosition.x,this.y=this.startPosition.y,this.setVelocity(0,0),this.body.setGravityY(0),this.angle=0,this.canJump=!0,this.startedJumpRestore=!1,this.alive=!0,this.setTexture(this.textureName)}OnGameOver(e){this.startGameOver=e}OnGameStart(e){this.startGame=e}}class r extends Phaser.GameObjects.TileSprite{static preload(e){e.load.image("bg","assets/sprites/background-night.png"),e.load.image("ground","assets/sprites/base.png")}constructor(e,t,s,i,a,r,o){super(e,t,s,i,a,r),this.speed=o,e.add.existing(this)}update(){this.tilePositionX-=this.speed}reset(){this.tilePositionX=0}}class o extends Phaser.Physics.Arcade.Sprite{static preload(e){e.load.image("pipe_bottom","assets/sprites/pipe_bottom.png"),e.load.image("pipe_top","assets/sprites/pipe_top.png")}constructor(e,t,s,i,a){super(e,t,s,i),e.add.existing(this),e.physics.add.existing(this),this.disableThreshold=this.width+20,this.body.allowGravity=!1,this.setPushable(!1),this.speed=a}update(){this.active&&(this.x+=this.speed,this.x<=-this.disableThreshold&&this.active&&this.disableBody(!0,!0))}}let n,h,d;class p{constructor(e,t,s){this.pipes=[],this.poolSize=t,this.poolIndex=0;for(var i=0;i<t;i++){var a=new o(e,-999,-999,"null",0);a.active=!1,this.pipes.push(a),n=a.width}d=e.cameras.main.width+n+20,h=e.cameras.main.height,this.lastDT=0,this.scene=e,this.scoreZones=e.physics.add.group({key:"null",repeat:t/2,visible:!1,allowGravity:!1,x:-99,y:-99}),this.scoreZones.children.iterate((e=>{e.body.setSize(5,150)})),this.pipeSpeed=s}Start(){this.CreatePipes("pipe_top","pipe_bottom",this.pipeSpeed),this.timer=this.scene.time.addEvent({delay:2500,startAt:0,callback:()=>{this.CreatePipes("pipe_top","pipe_bottom",this.pipeSpeed)},loop:!0})}Stop(){this.timer.remove()}Reset(){for(var e=0;e<this.poolSize;e++)this.pipes[e].y=-9999;this.scoreZones.children.iterate((e=>{e.y=-999}))}CreatePipes(e,t,s){let i=Phaser.Math.Between(100,h-200);var a,r;a=i,r=64,i=Math.round(a/r)*r+32,this.CreatePipe(e,s,i,!1),this.CreatePipe(t,s,i,!0)}CreatePipe(e,t,s,i){var a=this.pipes[this.poolIndex];if(a.active=!0,a.body.setEnable(!0),a.visible=!0,a.x=d,a.setOrigin(.5,i?0:1),a.y=s+(i?75:-75),a.speed=t,a.setTexture(e),a.body.setSize(a.width,a.height,!0),i){const e=this.scoreZones.children.entries[this.poolIndex%(this.poolSize/2)];e.x=d,e.y=s,e.body.setEnable(!0),e.active=!0}this.poolIndex++,this.poolIndex=this.poolIndex%this.poolSize}OnScore(e){this.scoreCallBack=e}update(){for(var e=0;e<this.poolSize;e++)this.pipes[e].update();this.scoreZones.children.iterate((e=>{e.active&&(e.body.x+=this.pipeSpeed)}))}}class l{constructor(e,t,s,i){this.numbers=[],this.alignment="center";for(var a=0;a<t;a++){let t=e.add.sprite(-100,-100,"score_font");this.numbers.push(t),t.setOrigin(0,.5)}}static preload(e){e.load.multiatlas("score_font","assets/sprites/font.json","assets/sprites")}SetScore(e){this.DrawScore(e,this.x,this.y)}DrawScore(e,t,s){if(this.Clear(),"number"!=typeof e)return console.error("Score is not a number");if(e%1!=0)return console.error("Score renderer does not support decimals");let i=e.toString(),a=i.length;a>this.numbers.length&&console.error("Score is larger than amount of digits available");let r=0;for(var o=0;o<a;o++){let e=this.numbers[o];e.y=s,e.setFrame(i[o]+".png"),e.x=t+r,r+=e.width+5}let n=0;"center"===this.alignment&&(n=r/2);for(o=0;o<a;o++){this.numbers[o].x-=n}this.x=t,this.y=s}Clear(){for(var e=0;e<this.numbers.length;e++)this.numbers[e].y=-100}}let c,m,u,g;class y{static preload(e){e.load.image("title","assets/sprites/titleCard.png"),e.load.image("tutorial","assets/sprites/tutorial.png"),e.load.image("game_over","assets/sprites/gameover.png")}constructor(t){c=t.add.image(400,t.cameras.main.height/4,"title"),c.setScale(2),t.tweens.add(e({targets:c,y:t.cameras.main.height/4+20},b)),m=t.add.image(400,t.cameras.main.height-250,"tutorial"),u=t.add.image(t.cameras.main.width/2,t.cameras.main.height+100,"game_over"),this.scene=t}RemoveTitleSprites(){this.scene.tweens.add(e({targets:c},v)),this.scene.tweens.add(e({targets:m},v))}ShowGameOver(){g=this.scene.tweens.add(e({targets:u},S))}Reset(){c.alpha=1,m.alpha=1,g.remove(),u.y=this.scene.cameras.main.height+100}}const b={duration:1500,ease:"Sine.inOut",yoyo:!0,repeat:-1},v={alpha:0,duration:300,ease:"Power2"},S={y:300,alpha:{from:0,to:1},duration:2e3,ease:"Bounce"};let w=new class{constructor(){this.Reset()}Reset(){this.current=e({},i)}};let x,f,O,R,P,G,_=[];class C extends t.Scene{constructor(){super("MainScene")}preload(){o.preload(this),a.preload(this),r.preload(this),l.preload(this),y.preload(this)}create(){x=new r(this,0,690,800,600,"bg",0).setOrigin(0,1),_.push(x),O=new a(this,100,this.cameras.main.height/4,"norby","norby_dead",t.Input.Keyboard.KeyCodes.UP),O.StartScreenBob(),O.OnGameStart((()=>this.StartGame())),O.OnGameOver((()=>this.EndGame())),R=new p(this,10,-2),R.pipes.map((e=>O.collideAgainst(e))),this.physics.add.overlap(O,R.scoreZones,this.AddScore,null,this),_.push(R),f=new r(this,0,650,800,100,"ground",-2).setOrigin(0,1),this.physics.add.existing(f,!0),O.collideAgainst(f),_.push(f),P=new l(this,4),G=new y(this),this.input.keyboard.on("keyup",(e=>{w.current.gameOver&&this.Reset()}))}update(){w.current.moving&&_.map((e=>e.update()))}AddScore(e,t){e.alive&&(P.SetScore(++w.current.score),t.x=-99,t.disableBody(!0,!0),this.sound.play("point"))}StartGame(){w.current.moving=!0,R.Start(),P.DrawScore(0,this.cameras.main.width/2,50),G.RemoveTitleSprites()}EndGame(){w.current.gameOver=!0,w.current.moving=!1,R.Stop(),G.ShowGameOver();const e=localStorage.getItem("best");w.current.score>e&&localStorage.setItem("best",w.current.score)}Reset(){G.Reset(),R.Reset(),w.Reset(),P.SetScore(0),O.Reset(),O.StartScreenBob(),x.tilePositionX=0,f.tilePositionX=0}}new t.Game(Object.assign(s,{scene:[C]}));
